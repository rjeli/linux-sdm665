/dts-v1/;
// version:		17
// last_comp_version:	16
// boot_cpuid_phys:	0x0

#include <dt-bindings/interrupt-controller/arm-gic.h>
#include <dt-bindings/clock/qcom,gcc-trinket.h>
#include <dt-bindings/clock/qcom,rpmcc.h>

/ {
    model = "Qualcomm Technologies, Inc. TRINKET SoC";
    compatible = "qcom,trinket";
    #address-cells = <0x00000002>;
    #size-cells = <0x00000002>;
    qcom,board-id = <0x22 0x0>;
    qcom,msm-id = <0x18a 0x10000>;
    interrupt-parent = <&wakegic>;
    chosen { };
    soc: soc { };
    aliases {
        serial0 = &qupv3_se4_2uart;
    };
    memory {
        device_type = "memory";
        reg = <0x00000000 0x00000000 0x00000000 0x00000000>;
    };
    cpus {
        #address-cells = <0x00000002>;
        #size-cells = <0x00000000>;
        CPU0: cpu@0 {
            device_type = "cpu";
            enable-method = "psci";
            reg = <0x00000000 0x00000000>;
            capacity-dmips-mhz = <0x00000400>;
            d-cache-size = <0x00008000>;
            i-cache-size = <0x00008000>;
            next-level-cache = <&L2_0>;
            compatible = "qcom,kryo260";
            L2_0: l2-cache {
                  compatible = "arm,arch-cache";
                  cache-size = <0x80000>;
                  cache-level = <2>;
            };
            l1-icache {
                compatible = "arm,arch-cache";
            };
            l1-dcache {
                compatible = "arm,arch-cache";
            };
        };
        CPU1: cpu@1 {
            device_type = "cpu";
            enable-method = "psci";
            reg = <0x00000000 0x00000001>;
            capacity-dmips-mhz = <0x00000400>;
            d-cache-size = <0x00008000>;
            i-cache-size = <0x00008000>;
            next-level-cache = <&L2_0>;
            compatible = "qcom,kryo260";
            l1-icache {
                compatible = "arm,arch-cache";
            };
            l1-dcache {
                compatible = "arm,arch-cache";
            };
        };
        CPU2: cpu@2 {
            device_type = "cpu";
            enable-method = "psci";
            reg = <0x00000000 0x00000002>;
            capacity-dmips-mhz = <0x00000400>;
            d-cache-size = <0x00008000>;
            i-cache-size = <0x00008000>;
            next-level-cache = <&L2_0>;
            compatible = "qcom,kryo260";
            l1-icache {
                compatible = "arm,arch-cache";
            };
            l1-dcache {
                compatible = "arm,arch-cache";
            };
        };
        CPU3: cpu@3 {
            device_type = "cpu";
            enable-method = "psci";
            reg = <0x00000000 0x00000003>;
            capacity-dmips-mhz = <0x00000400>;
            d-cache-size = <0x00008000>;
            i-cache-size = <0x00008000>;
            next-level-cache = <&L2_0>;
            compatible = "qcom,kryo260";
            l1-icache {
                compatible = "arm,arch-cache";
            };
            l1-dcache {
                compatible = "arm,arch-cache";
            };
        };
        CPU4: cpu@100 {
            device_type = "cpu";
            enable-method = "psci";
            reg = <0x00000000 0x00000100>;
            capacity-dmips-mhz = <0x00000666>;
            d-cache-size = <0x00010000>;
            i-cache-size = <0x00010000>;
            next-level-cache = <&L2_1>;
            compatible = "qcom,kryo260";
            L2_1: l2-cache {
                  compatible = "arm,arch-cache";
                  cache-size = <0x100000>;
                  cache-level = <2>;
            };
            l1-icache {
                compatible = "arm,arch-cache";
            };
            l1-dcache {
                compatible = "arm,arch-cache";
            };
        };
        CPU5: cpu@101 {
            device_type = "cpu";
            enable-method = "psci";
            reg = <0x00000000 0x00000101>;
            capacity-dmips-mhz = <0x00000666>;
            d-cache-size = <0x00010000>;
            i-cache-size = <0x00010000>;
            next-level-cache = <&L2_1>;
            compatible = "qcom,kryo260";
            l1-icache {
                compatible = "arm,arch-cache";
            };
            l1-dcache {
                compatible = "arm,arch-cache";
            };
        };
        CPU6: cpu@102 {
            device_type = "cpu";
            enable-method = "psci";
            reg = <0x00000000 0x00000102>;
            capacity-dmips-mhz = <0x00000666>;
            d-cache-size = <0x00010000>;
            i-cache-size = <0x00010000>;
            next-level-cache = <&L2_1>;
            compatible = "qcom,kryo260";
            l1-icache {
                compatible = "arm,arch-cache";
            };
            l1-dcache {
                compatible = "arm,arch-cache";
            };
        };
        CPU7: cpu@103 {
            device_type = "cpu";
            enable-method = "psci";
            reg = <0x00000000 0x00000103>;
            capacity-dmips-mhz = <0x00000666>;
            d-cache-size = <0x00010000>;
            i-cache-size = <0x00010000>;
            next-level-cache = <&L2_1>;
            compatible = "qcom,kryo260";
            l1-icache {
                compatible = "arm,arch-cache";
            };
            l1-dcache {
                compatible = "arm,arch-cache";
            };
        };
        cpu-map {
            cluster0 {
                core0 {
                    cpu = <&CPU0>;
                };
                core1 {
                    cpu = <&CPU1>;
                };
                core2 {
                    cpu = <&CPU2>;
                };
                core3 {
                    cpu = <&CPU3>;
                };
            };
            cluster1 {
                core0 {
                    cpu = <&CPU4>;
                };
                core1 {
                    cpu = <&CPU5>;
                };
                core2 {
                    cpu = <&CPU6>;
                };
                core3 {
                    cpu = <&CPU7>;
                };
            };
        };
    };
    reserved-memory {
        #address-cells = <0x00000002>;
        #size-cells = <0x00000002>;
        ranges;
    };

};

&soc {
    #address-cells = <1>;
    #size-cells = <1>;
    ranges = <0 0 0 0xffffffff>;
    compatible = "simple-bus";

    clocks {
        sleep_clk: sleep-clk {
            compatible = "fixed-clock";
            clock-frequency = <32000>;
            clock-output-names = "chip_sleep";
            #clock-cells = <1>;
        };

        xo_board {
            compatible = "fixed-clock";
            #clock-cells = <0>;
            clock-frequency = <19200000>;
            clock-output-names = "xo_board";
        };
    };

    wakegic: wake-gic {
        compatible = "qcom,mpm-gic-trinket", "qcom,mpm-gic";
        interrupts-extended = <&wakegic GIC_SPI 197 IRQ_TYPE_EDGE_RISING>;
        reg = <0x45f01b8 0x1000>, <0xf011008 0x4>;  // MSM_APCS_GCC_BASE 4K
        reg-names = "vmpm", "ipc";
        qcom,num-mpm-irqs = <96>;
        interrupt-controller;
        interrupt-parent = <&intc>;
        #interrupt-cells = <3>;
    };

    wakegpio: wake-gpio {
        compatible = "qcom,mpm-gpio-trinket", "qcom,mpm-gpio";
        interrupt-controller;
        interrupt-parent = <&intc>;
        #interrupt-cells = <2>;
    };

    intc: interrupt-controller@f200000 {
        compatible = "arm,gic-v3";
        #interrupt-cells = <3>;
        interrupt-controller;
        interrupt-parent = <&intc>;
        #redistributor-regions = <1>;
        redistributor-stride = <0x0 0x20000>;
        reg = <0xf200000 0x10000>,     
              <0xf300000 0x100000>;   /* GICD, GICR * 8 */
        interrupts = <1 9 4>;
    };

    timer {
        compatible = "arm,armv8-timer";
        interrupts = <1 1 0xf08>,
                 <1 2 0xf08>,
                 <1 3 0xf08>,
                 <1 0 0xf08>;
        clock-frequency = <19200000>;
    };

    timer@f120000 {
        #address-cells = <1>;
        #size-cells = <1>;
        ranges;
        compatible = "arm,armv7-timer-mem";
        reg = <0xf120000 0x1000>;
        clock-frequency = <19200000>;

        frame@f121000 {
            frame-number = <0>;
            interrupts = <0 8 0x4>,
                     <0 7 0x4>;
            reg = <0xf121000 0x1000>,
                  <0xf122000 0x1000>;
        };

        frame@f123000 {
            frame-number = <1>;
            interrupts = <0 9 0x4>;
            reg = <0xf123000 0x1000>;
            status = "disabled";
        };

        frame@f124000 {
            frame-number = <2>;
            interrupts = <0 10 0x4>;
            reg = <0xf124000 0x1000>;
            status = "disabled";
        };

        frame@f125000 {
            frame-number = <3>;
            interrupts = <0 11 0x4>;
            reg = <0xf125000 0x1000>;
            status = "disabled";
        };

        frame@f126000 {
            frame-number = <4>;
            interrupts = <0 12 0x4>;
            reg = <0xf126000 0x1000>;
            status = "disabled";
        };

        frame@f127000 {
            frame-number = <5>;
            interrupts = <0 13 0x4>;
            reg = <0xf127000 0x1000>;
            status = "disabled";
        };

        frame@f128000 {
            frame-number = <6>;
            interrupts = <0 14 0x4>;
            reg = <0xf128000 0x1000>;
            status = "disabled";
        };
    };

    psci {
        compatible = "arm,psci-1.0";
        method = "smc";
    };

    gcc: clock-controller@1400000 {
        compatible = "qcom,gcc-trinket", "syscon";
        reg = <0x1400000 0x1f0000>;
        // reg-names = "cc_base";
        // vdd_cx-supply = <&VDD_CX_LEVEL>;
        // vdd_cx_ao-supply = <&VDD_CX_LEVEL_AO>;
        #clock-cells = <1>;
        #reset-cells = <1>;
    };

    apcs_glb: mailbox@0f111000 {
        compatible = "qcom,sdm665-apcs-hmss-global";
        reg = <0x0f111000 0x1000>;
        #mbox-cells = <1>;
    };

    rpm_msg_ram: memory@045f0000 {
        compatible = "qcom,rpm-msg-ram";
        reg = <0x045f0000 0x7000>;
    };

    rpm-glink {
        compatible = "qcom,glink-rpm";
        interrupts = <GIC_SPI 194 IRQ_TYPE_EDGE_RISING>;
        qcom,rpm-msg-ram = <&rpm_msg_ram>;
        mboxes = <&apcs_glb 0>;
        rpm-requests {
            compatible = "qcom,rpm-sdm665";
            qcom,glink-channels = "rpm_requests";

            rpmcc: clock-controller {
                compatible = "qcom,rpmcc-sdm665", "qcom,rpmcc";
                #clock-cells = <1>;
            };

            smd_rpm_regulators: pm6125-regulators {
                compatible = "qcom,rpm-pm6125-regulators";
                pm6125_l7: l7 {
                    regulator-min-microvolt = <872000>;
                    regulator-max-microvolt = <976000>;
                    regulator-always-on;
                };
                pm6125_l10: l10 {
                    regulator-min-microvolt = <1800000>;
                    regulator-max-microvolt = <1896000>;
                    regulator-always-on;
                };
                pm6125_l15: l15 {
                    regulator-min-microvolt = <3104000>;
                    regulator-max-microvolt = <3232000>;
                    // regulator-always-on;
                };
            };
        };
    };

    qupv3_0: geniqup@4ac0000 {
        compatible = "qcom,geni-se-qup";
        reg = <0x4ac0000 0x2000>;
        clock-names = "m-ahb", "s-ahb";
        clocks = <&gcc GCC_QUPV3_WRAP_0_M_AHB_CLK>, 
                 <&gcc GCC_QUPV3_WRAP_0_S_AHB_CLK>;
        #address-cells = <1>;
        #size-cells = <1>;
        ranges;

        qupv3_se4_2uart: serial@0x4a90000 {
            compatible = "qcom,geni-debug-uart";
            reg = <0x4a90000 0x4000>;
            interrupts = <GIC_SPI 331 0>;
            clock-names = "se";
            clocks = <&gcc GCC_QUPV3_WRAP0_S4_CLK>;
        };
    };

    qusb_phy0: qusb@1613000 {
        compatible = "qcom,sdm665-qusb2-phy";
        reg = <0x01613000 0x180>;
        #phy-cells = <0>;

        clocks = <&gcc GCC_AHB2PHY_USB_CLK>, <&rpmcc RPM_SMD_CXO_OTG_CLK>;
        clock-names = "cfg_ahb", "ref";

        // core vdd, either NONE or LOWER
        // FIXME
        // vdd = <&pm6125_l7>;
        // 1.8
        vdda-pll-supply = <&pm6125_l10>;
        // 3.1
        vdda-phy-dpdm-supply = <&pm6125_l15>;

        resets = <&gcc GCC_QUSB2PHY_PRIM_BCR>;
    };

    usb0: ssusb@4e00000 {
        compatible = "qcom,dwc3";
        reg = <0x4e00000 0x100000>;
        #address-cells = <1>;
        #size-cells = <1>;
        ranges;

        interrupt-names = "hs_phy_irq", "ss_phy_irq";
        interrupts = <0 260 0>, <0 422 0>;

        clock-names = "core", "iface", "cfg_noc", "xo", "sleep", "mock_utmi";
        clocks = <&gcc GCC_USB30_PRIM_MASTER_CLK>,
                 <&gcc GCC_SYS_NOC_USB3_PRIM_AXI_CLK>,
                 <&gcc GCC_CFG_NOC_USB3_PRIM_AXI_CLK>,
                 <&gcc GCC_USB3_PRIM_CLKREF_CLK>,
                 <&gcc GCC_USB30_PRIM_SLEEP_CLK>,
                 <&gcc GCC_USB30_PRIM_MOCK_UTMI_CLK>;

        assigned-clocks = <&gcc GCC_USB30_PRIM_MASTER_CLK>,
            <&gcc GCC_USB30_PRIM_MOCK_UTMI_CLK>;
        assigned-clock-rates = <66666667>, <19200000>;

        resets = <&gcc GCC_USB30_PRIM_BCR>;
        reset-names = "core_reset";

        dwc3@4e00000 {
            compatible = "snps,dwc3";
            reg = <0x4e00000 0xcd00>;
            interrupt-parent = <&intc>;
            interrupts = <0 255 0>;
            usb-phy = <&qusb_phy0>, <&usb_nop_phy>;
            tx-fifo-resize;
            // linux,sysdev_is_parent;
            // snps,disable-clk-gating;
            snps,dis_u2_susphy_quirk;
            snps,dis_enblslpm_quirk;
            snps,has-lpm-erratum;
            snps,hird-threshold = /bits/ 8 <0x10>;
            snps,usb3_lpm_capable;
            maximum-speed = "high-speed";
            dr_mode = "peripheral";
        };
    };


    usb_nop_phy: usb_nop_phy {
        compatible = "usb-nop-xceiv";
    };

    /*
    tlmm: pinctrl@400000 {
        compatible = "qcom,trinket-pinctrl";
        reg = <0x400000 0xc00000>;
        reg-names = "pinctrl";
        interrupts-extended = <&wakegic GIC_SPI 227 IRQ_TYPE_NONE>;
        gpio-controller;
        #gpio-cells = <2>;
        interrupt-controller;
        interrupt-parent = <&wakegpio>;
        #interrupt-cells = <2>;
    };
    */
};
